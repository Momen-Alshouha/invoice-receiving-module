<div class="container my-4 m-0">
  <!-- Global Search Filter -->

  <div class="form-group w-100">
    <div class="d-flex justify-content-between align-items-center">
      <div class="flex-grow-1 me-2">
        <input
          type="text"
          id="searchInput"
          class="form-control w-50"
          [(ngModel)]="searchText"
          (input)="applyFilter()"
          placeholder="Search by Invoice Seq, Supplier, or Invoice No."
        />
      </div>

    <div class="d-flex flex-column gap-2">
        <button class="new-invoice-btn btn btn-dark" routerLink="/add-invoice">
            <i class="bi bi-plus"></i> New Invoice
          </button>
          <p class="m-0">
            <span class="rowsNo"># Rows: {{ filteredInvoices.length }}</span> 
          </p>    
    </div>
    </div>
  </div>

  <div class="table-responsive">
    <table class="table table-striped table-bordered">
      <thead class="table-light">
        <tr>
          <th scope="col">
            Invoice Seq
            <button
              class="btn btn-link p-0 ms-2"
              (click)="toggleInvoiceSeqSearch()"
              title="Search by Invoice Seq"
            >
              <i class="bi bi-search"></i>
            </button>
            <div *ngIf="showInvoiceSeqSearch" class="mt-2">
              <input
                type="text"
                class="form-control form-control-sm"
                [(ngModel)]="searchInvoiceSeq"
                (input)="applyFilter()"
                placeholder="Search Invoice Seq"
              />
            </div>
          </th>
          <th scope="col" class="w-25">Supplier</th>
          <th scope="col">Invoice No</th>
          <th scope="col">
            Creation Date
            <app-datepicker
              (dateSelected)="onDateSelected($event)"
            ></app-datepicker>
          </th>
          <th class="th-status" scope="col">
            <select
              class="form-select form-select-sm"
              [(ngModel)]="selectedStatus"
              (change)="applyFilter()"
              aria-label="Filter by Status"
            >
              <option [ngValue]="null" disabled selected>Status</option>
              <option *ngFor="let status of statuses" [ngValue]="status.value">
                {{ status.label }}
              </option>
            </select>
          </th>
          <th><i class="bi bi-three-dots-vertical"></i></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let invoice of filteredInvoices">
          <td>{{ invoice.invoiceSeq ?? "N/A" }}</td>
          <td>{{ invoice.supplierName ?? "N/A" }}</td>
          <td>{{ invoice.invoiceNumber ?? "N/A" }}</td>
          <td>
            {{
              invoice.invoiceDate
                ? (invoice.invoiceDate | date : "yyyy-MM-dd")
                : "N/A"
            }}
          </td>
          <td>
            {{
              invoice.statusId === 1
                ? "Draft"
                : invoice.statusId === 2
                ? "Created"
                : "Unknown"
            }}
          </td>
          <td><i class="bi bi-three-dots-vertical"></i></td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
